# KingsView

> **Shape Kingston's Golden Age.**  
> A 3D urban planning platform where you design buildings with your voice, place them on a live map, and simulate environmental impact â€” before the first shovel hits the ground.

Built for the **City of Kingston** at **QHacks 2025**.

---

## ğŸ† Prize Tracks

KingsView is built to shine on **both** QHacks prize tracks. Here's how we leaned in.

### ğŸ™ï¸ ElevenLabs Track â€” Sound That Brings the Editor to Life

**Every sound effect in the Building Editor is generated by ElevenLabs.**

We didn't use stock audio. We used the **ElevenLabs Sound Generation API** to create 9 custom sound effects from natural-language prompts. Each action in the editorâ€”placing a brick, adding a floor, resizing, rotatingâ€”triggers a unique, AI-generated sound.

| Action | Prompt Used | Output |
|--------|-------------|--------|
| Place object | "A fast whoosh followed by a soft landing thud, like something flying in and dropping into place" | `place_object.mp3` |
| Add floor | "A satisfying plastic lego brick snapping and clicking into place, crisp snap click sound, short and punchy" | `add_floor.mp3` |
| Resize | "A rubber stretching and elastic pulling sound, like a material being stretched out longer with tension" | `resize_object.mp3` |
| Change texture | "A quick light whoosh, like a card being flipped or a page turning fast in the wind" | `change_texture.mp3` |
| Window add | "A solid block clicking into place with a satisfying snap and a short bam, like a lego brick being pressed down firmly" | `window_add.mp3` |
| ...and 4 more | Custom prompts for each interaction | Full UI sound design |

**Run the generator yourself:**
```bash
npm run generate-sounds
```

We also use **ElevenLabs Text-to-Speech** for voice feedback: when you describe a building and Gemini designs it, ElevenLabs speaks the confirmation back to you. The `/api/speak` route streams TTS for any textâ€”making the Voice Design feature feel alive.

---

### ğŸ¤– Gemini Track â€” AI-Powered Design & Analysis

**Gemini is the brain behind three core features.**

1. **Voice Design** â€” Describe a building in plain English. Gemini parses your speech into a structured building config (floors, dimensions, roof style, texture, windows, color), validates it with Zod, and retries on schema errors. *"A 5-story modern glass tower with a flat roof"* â†’ instant 3D.

2. **Environmental Impact Report** â€” Place buildings on the map with a construction timeline. Gemini generates a full report: carbon footprint, habitat disruption, water impact, traffic, noise, community effect, and mitigation measures. Snapshot at any date.

3. **Tree Advisor** â€” Ask questions about Kingston's Neighbourhood Tree Planting Program. Gemini recommends species from the official Kingston dataset (40+ trees), with density, radius, reasoning, and planting tipsâ€”all grounded in real municipal data.

---

## âœ¨ What We Built

- **3D Map** â€” Kingston in Three.js: OpenStreetMap buildings, satellite-textured roads, real traffic signals, A* pathfinding, 100+ simulated vehicles with turn signals and brake lights.
- **Building Editor** â€” Design from blueprints or from scratch. Floors, roofs, windows, textures, doors. Trace floor plans. Export as GLB or GeoJSON.
- **Voice Design** â€” Speak your building. Listen to the confirmation. See it render in real time.
- **Place on Map** â€” Drop buildings onto real coordinates. Construction timeline, noise ripples, population sentiment (Happy/Sad score).
- **Environmental Report** â€” COâ‚‚, energy, water, sustainability score. Generate a PDF-ready impact report.
- **Zoning Layer** â€” Kingston Official Plan land-use overlay.
- **Tree Advisor** â€” AI tree recommendations for your project, backed by Kingston's tree database.

---

## ğŸ›  Tech Stack

| Layer | Tech |
|-------|------|
| Frontend | Next.js 16, React 19, Tailwind CSS, Framer Motion |
| 3D | Three.js, React Three Fiber, Drei |
| AI | **Google Gemini 2.5 Flash** (design parser, environmental report, tree advisor) |
| Voice & Sound | **ElevenLabs** (TTS + Sound Generation API), Web Speech API |
| Data | Turf.js, OpenStreetMap, Kingston zoning & tree data |
| Traffic | A* pathfinding, signal coordination, vehicle physics, LOD + object pooling |

---

## ğŸš€ Quick Start

```bash
# Install
npm install

# Add API keys to .env.local
# GEMINI_API_KEY=...
# ELEVENLABS_API_KEY=...

# Run
npm run dev
```

Open [http://localhost:3000](http://localhost:3000).

- **Explore** â†’ 3D map of Kingston  
- **Build** â†’ Building Editor (voice, blueprints, export)

---

## ğŸ“ Project Structure

```
app/
â”œâ”€â”€ page.tsx          # Landing (Golden Age theme)
â”œâ”€â”€ map/page.tsx      # 3D map + placement + timeline + metrics
â”œâ”€â”€ editor/page.tsx   # Building editor
â””â”€â”€ api/
    â”œâ”€â”€ design/       # Gemini: voice â†’ building config
    â”œâ”€â”€ speak/        # ElevenLabs TTS
    â”œâ”€â”€ environmental-report/  # Gemini: impact analysis
    â””â”€â”€ tree-advisor/ # Gemini: tree recommendations

lib/
â”œâ”€â”€ editor/           # Building editor logic, VoiceDesign, SoundManager
â”œâ”€â”€ traffic/          # A*, signals, vehicle behavior
â”œâ”€â”€ constructionNoise.ts
â”œâ”€â”€ kingstonZoning.ts
â””â”€â”€ ...

public/sounds/building/  # ElevenLabs-generated sound effects
scripts/generate-sounds.mjs  # ElevenLabs Sound Generation script
```

---

## ğŸŒŸ Why KingsView?

Cities grow faster than we can plan for them. Before breaking ground, Kingston deserves to **see** what it will look like, **hear** the impact, and **measure** the costâ€”to traffic, air, and community.

KingsView is built for that moment. Design smarter. Build responsibly. **Shape a new Golden Age.**

---

*Built for the City of Kingston at QHacks 2025.*
